{% extends "exmo2010/email_base.html" %}
{% comment %}
# This file is part of EXMO2010 software.
# Copyright 2010, 2011, 2013 Al Nikolov
# Copyright 2010, 2011 non-profit partnership Institute of Information Freedom Development
# Copyright 2012-2014 Foundation "Institute for Information Freedom Development"
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
{% endcomment %}
{% load i18n get_object_by_pk future %}

{% block title %}
    Report from {{ start_date }} to {{ end_date }}
{% endblock %}

{% block content %}
    <h3>Report from {{ start_date }} to {{ end_date }}</h3>

    <div>
        Note:
        Limit is {{ time_to_answer }} days.
    </div>

    <h4>Statistics:</h4>
    <div>
        Total organizations in monitoring: {{ total_org }}<br />
        Registered organizations: {{ organizations_with_representatives }}<br />
        Organizations with comments from organization: {{ active_organization_stats|length }}<br />
        Comments count from organizations: {{ org_comments }}<br />
        Comments count from organizations with reply date in limit: {{ comments_with_reply|length }}<br />
        Comments count from organizations with reply date out of limit: {{ fail_comments_with_reply|length }}<br />
        Comments count from organizations without reply and date in limit: {{ comments_without_reply|length }}<br />
        Comments count from organizations without reply and should be answered today: {{ fail_soon_comments_without_reply|length }}<br />
        Comments count from organizations without reply and date out of limit: {{ fail_comments_without_reply|length }}<br />
    </div>

    <div>
        <h4>Statistics by organization:</h4>
        {% for active_organization in active_organization_stats %}
            {{ active_organization.org }}: {{ active_organization.comments_count }} ({{ active_organization.task.user }})<br />
        {% endfor %}
    </div>

    <div>
        <h4>Statistics by iifd employers:</h4>
        {% for active_operator_person in active_operator_person_stats %}
            {{ active_operator_person }}: {{ active_operator_person.comments_count }}<br />
        {% endfor %}
        Total: {{ operator_all_comments }}
    </div>


    <div>
        <h4>Comments list from organizations without reply and date out of limit ({{ fail_comments_without_reply|length }}):</h4>
        {% for c in fail_comments_without_reply %}
            {% get_object_by_pk exmo2010.Score c.object_pk as score %}
            {{ c.submit_date }} -- {{ c.user }} -- {{ site }}{% url 'exmo2010:score_view' c.object_pk %} ({{score.task.user}})<br />
        {% endfor %}
    </div>

    <div>
        <h4>Comments list from organization that needs to reply today (exclude list above) ({{ fail_soon_comments_without_reply|length }}):</h4>
        {% for c in fail_soon_comments_without_reply %}
            {% get_object_by_pk exmo2010.Score c.object_pk as score %}
            {{ c.submit_date }} -- {{ c.user }} -- {{ site }}{% url 'exmo2010:score_view' c.object_pk %} ({{score.task.user}})<br />
        {% endfor %}
    </div>

    <div>
        <h4>Comments list from organization that needs to reply (exclude list above) ({{ comments_without_reply|length }}):</h4>
        {% for c in comments_without_reply %}
            {% get_object_by_pk exmo2010.Score c.object_pk as score %}
            {{ c.submit_date }} -- {{ c.user }} -- {{ site }}{% url 'exmo2010:score_view' c.object_pk %} ({{score.task.user}})<br />
        {% endfor %}
    </div>
{% endblock content %}
